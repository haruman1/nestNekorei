import{r as s,R as H,j as t,C}from"./index-LIEJRkrL.js";import{a as u}from"./cil-lock-locked-zwVFJp_A.js";import{c as N,X as O,C as R,a as $,b as K,d as P,e as X}from"./index.es-D7HV7J-o.js";import{C as q}from"./index.esm-CWSLtNjm.js";import{H as G}from"./Helmet-DUZFqjzQ.js";import{v as V}from"./FileUploaderInline-Bh2g56u4-Dfii3n_o.js";import{a as J}from"./CContainer-BoogBarz.js";import{C as Q,a as W}from"./CCardBody-QOkoizK2.js";import{C as Y}from"./CCardHeader-CBqz6_vZ.js";import{C as n}from"./CButton-DxiArMZ_.js";import{b as y,C as Z}from"./CFormInput-DqRM0xn9.js";import"./DefaultLayout-D8bFV0MU.js";import"./routes-6VyFrxE3.js";import"./Transition-TKWYJH10.js";import"./cil-user-Ddrdy7PS.js";import"./isInViewport-BGGX6NGH.js";const he=()=>{const[c,i]=s.useState(!0),[S,j]=s.useState([]),[w,g]=s.useState([]),[b,k]=s.useState(""),[v,h]=H.useState(!0),[E,T]=s.useState(""),[B,D]=s.useState(""),[o,L]=s.useState(null),[F,l]=s.useState(!1),[x,d]=s.useState({name:"",image:""}),m=async()=>{i(!0),h(!0);try{const e=await u.get("http://localhost:3001/products/categories",{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}});if(e.data.status===200){const a=e.data.data;j(a),g(a)}}catch(e){console.error("Error fetching data:",e)}finally{i(!1),h(!1)}},f=(e,a)=>{a==="edit"&&d({name:e.name,image:e.image}),L({...e,action:a}),l(!0)},z=e=>{const a=e.target.value.toLowerCase();k(a);const r=S.filter(p=>p.name.toLowerCase().includes(a)||p.id.toLowerCase().includes(a)||p.image.toLowerCase().includes(a));g(r)},I=e=>{const{name:a,value:r}=e.target;d({...x,[a]:r})},U=async()=>{o.action==="edit"||o.action==="delete"&&await u.delete(`http://localhost:3001/products/categories/${o.id}`,{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).then(e=>{e.status===200?(m(),Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:r=>{r.onmouseenter=Swal.stopTimer,r.onmouseleave=Swal.resumeTimer}}).fire({icon:"success",title:e.data.message}),setTimeout(()=>{i(!1)},3e3)):(Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:r=>{r.onmouseenter=Swal.stopTimer,r.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:e.data.message}),setTimeout(()=>{i(!1)},3e3))}).catch(e=>{onError(e),Swal.fire("Error","Failed to Delete produk karena "+e.response.message,"error")}),l(!1)},M=async()=>{u.get("http://localhost:3001/users/image/upload").then(e=>{if(e.status===200){const a=e.data;T(a.secureSignature),D(a.secureExpire),console.log(a)}}).catch(e=>{onError("Error fetching signature:",e)})};s.useEffect(()=>{M(),m()},[]);const A=[{name:"No",cell:(e,a)=>a+1,width:"50px",sortable:!1},{name:"ID",selector:e=>e.id,sortable:!0,style:{padding:"4px 8px",fontSize:"14px"}},{name:"Name",selector:e=>e.name,sortable:!0,style:{padding:"4px 8px",fontSize:"14px"}},{name:"Image",selector:e=>e.image?t.jsx("img",{src:`https://ucarecdn.com/${e.image}/`,alt:"Kategori",style:{height:40,width:40}}):t.jsx("img",{src:"https://via.placeholder.com/40x40",alt:"placeholder"}),style:{textAlign:"center"}},{name:"Actions",cell:e=>t.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"10px"},children:[t.jsx(n,{variant:"outline",color:"info",size:"sm",onClick:()=>f(e,"edit"),children:"Edit"}),t.jsx(n,{variant:"outline",color:"danger",size:"sm",onClick:()=>f(e,"delete"),children:"Delete"})]}),width:"150px"}];return t.jsxs(t.Fragment,{children:[t.jsxs(G,{children:[t.jsx("title",{children:"List Produk - Nekorei Management"}),t.jsx("meta",{name:"description",content:"List Produk yang tersedia di Nekoreishion Management"})]}),t.jsx(J,{children:t.jsxs(Q,{style:{margin:"10px"},children:[t.jsxs(Y,{children:[t.jsx("h3",{style:{marginBottom:"10px",textAlign:"center"},children:"Kategori List"}),t.jsx(n,{color:"primary",onClick:m,disabled:c,style:{float:"right",marginBottom:"10px"},children:c?t.jsx(C,{size:"sm"}):t.jsx(q,{icon:N})})]}),t.jsxs(W,{style:{padding:"10px"},children:[t.jsx(y,{type:"text",placeholder:"Search by Name, Description, or ID...",value:b,onChange:z,style:{marginBottom:"10px",width:"300px"}}),c?t.jsx(C,{color:"primary"}):t.jsx(O,{columns:A,data:w,progressPending:v,pagination:!0,highlightOnHover:!0,pointerOnHover:!0,responsive:!0,striped:!0,customStyles:{table:{style:{padding:"0",margin:"0"}},headRow:{style:{padding:"1px 2px",fontSize:"11px"}},rows:{style:{minHeight:"25px",padding:"2px"}},cells:{style:{padding:"2px 3px",fontSize:"11px"}}}})]})]})}),t.jsxs(R,{backdrop:"static",visible:F,onClose:()=>l(!1),children:[t.jsx($,{children:t.jsx(K,{children:(o==null?void 0:o.action)==="delete"?"Confirm Delete":"Edit Product"})}),t.jsx(P,{children:(o==null?void 0:o.action)==="delete"?`Apa kamu yakin mau menghapus kategori ${o==null?void 0:o.name} ?`:t.jsxs(t.Fragment,{children:[t.jsx(y,{label:"Name",name:"name",value:x.name,onChange:I,style:{marginBottom:"10px"}}),t.jsx(Z,{children:"Unggah Gambar Category Produk"}),t.jsx(V,{pubkey:"ff2ab64366bd0dd50104",maxLocalFileSizeBytes:5e3,multiple:!1,sourceList:"local, url, gdrive",useCloudImageEditor:!0,secureSignature:E,secureExpire:B,onFileUploadStart:()=>i(!0),classNameUploader:"my-config uc-auto",onFileUploadSuccess:e=>{i(!1),d(a=>({...a,image:e.uuid})),console.log(e)}})]})}),t.jsxs(X,{children:[t.jsx(n,{color:"secondary",onClick:()=>l(!1),children:"Cancel"}),t.jsx(n,{color:"primary",onClick:U,children:(o==null?void 0:o.action)==="delete"?"Delete":"Save Changes"})]})]})]})};export{he as default};
