import{r as o,R as N,j as t,C as y}from"./index-DsVamXnW.js";import{a as g,S as i}from"./sweetalert2.esm.all-CJaJeW5u.js";import{c as O,X as q,C as R,a as $,b as K,d as P,e as X}from"./index.es-U0pKQLhm.js";import{C as G}from"./index.esm-CDU6puz1.js";import{H as V}from"./Helmet-DiQ4eAka.js";import{v as J}from"./FileUploaderInline-Bh2g56u4-vqgctLJZ.js";import{a as Q}from"./CContainer-kqqaBj-4.js";import{C as W,a as Y}from"./CCardBody-PrrWRnlc.js";import{C as Z}from"./CCardHeader-CR9vJKrj.js";import{C as l}from"./CButton-BtZs5GAv.js";import{b as j,C as _}from"./CFormInput-BKe5CyvR.js";import"./DefaultLayout-DR5UwGt3.js";import"./CNavLink-BfngBy3P.js";import"./Transition-ilpF5HQZ.js";import"./cil-user-Ddrdy7PS.js";import"./isInViewport-BGGX6NGH.js";const he=()=>{const[d,n]=o.useState(!0),[S,b]=o.useState([]),[k,x]=o.useState([]),[v,E]=o.useState(""),[T,h]=N.useState(!0),[w,B]=o.useState(""),[D,z]=o.useState(""),[s,L]=o.useState(null),[F,c]=o.useState(!1),[f,m]=o.useState({name:"",image:""}),p=async()=>{n(!0),h(!0);try{const e=await g.get("https://x-yq.xyz/products/categories",{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}});if(e.data.status===200){const a=e.data.data;b(a),x(a)}}catch(e){console.error("Error fetching data:",e)}finally{n(!1),h(!1)}},C=(e,a)=>{a==="edit"&&m({name:e.name,image:e.image}),L({...e,action:a}),c(!0)},I=e=>{const a=e.target.value.toLowerCase();E(a);const r=S.filter(u=>u.name.toLowerCase().includes(a)||u.id.toLowerCase().includes(a)||u.image.toLowerCase().includes(a));x(r)},U=e=>{const{name:a,value:r}=e.target;m({...f,[a]:r})},M=async()=>{s.action==="edit"||s.action==="delete"&&await g.delete(`https://x-yq.xyz/products/categories/${s.id}`,{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).then(e=>{e.status===200?(p(),i.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:r=>{r.onmouseenter=i.stopTimer,r.onmouseleave=i.resumeTimer}}).fire({icon:"success",title:e.data.message}),setTimeout(()=>{n(!1)},3e3)):(i.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:r=>{r.onmouseenter=i.stopTimer,r.onmouseleave=i.resumeTimer}}).fire({icon:"error",title:e.data.message}),setTimeout(()=>{n(!1)},3e3))}).catch(e=>{onError(e),i.fire("Error","Failed to Delete produk karena "+e.response.message,"error")}),c(!1)},A=async()=>{g.get("https://x-yq.xyz/users/image/upload").then(e=>{if(e.status===200){const a=e.data;B(a.secureSignature),z(a.secureExpire),console.log(a)}}).catch(e=>{onError("Error fetching signature:",e)})};o.useEffect(()=>{A(),p()},[]);const H=[{name:"No",cell:(e,a)=>a+1,width:"50px",sortable:!1},{name:"ID",selector:e=>e.id,sortable:!0,style:{padding:"4px 8px",fontSize:"14px"}},{name:"Name",selector:e=>e.name,sortable:!0,style:{padding:"4px 8px",fontSize:"14px"}},{name:"Image",selector:e=>e.image?t.jsx("img",{src:`https://ucarecdn.com/${e.image}/`,alt:"Kategori",style:{height:40,width:40}}):t.jsx("img",{src:"https://via.placeholder.com/40x40",alt:"placeholder"}),style:{textAlign:"center"}},{name:"Actions",cell:e=>t.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"10px"},children:[t.jsx(l,{variant:"outline",color:"info",size:"sm",onClick:()=>C(e,"edit"),children:"Edit"}),t.jsx(l,{variant:"outline",color:"danger",size:"sm",onClick:()=>C(e,"delete"),children:"Delete"})]}),width:"150px"}];return t.jsxs(t.Fragment,{children:[t.jsxs(V,{children:[t.jsx("title",{children:"List Produk - Nekorei Management"}),t.jsx("meta",{name:"description",content:"List Produk yang tersedia di Nekoreishion Management"})]}),t.jsx(Q,{children:t.jsxs(W,{style:{margin:"10px"},children:[t.jsxs(Z,{children:[t.jsx("h3",{style:{marginBottom:"10px",textAlign:"center"},children:"Kategori List"}),t.jsx(l,{color:"primary",onClick:p,disabled:d,style:{float:"right",marginBottom:"10px"},children:d?t.jsx(y,{size:"sm"}):t.jsx(G,{icon:O})})]}),t.jsxs(Y,{style:{padding:"10px"},children:[t.jsx(j,{type:"text",placeholder:"Search by Name, Description, or ID...",value:v,onChange:I,style:{marginBottom:"10px",width:"300px"}}),d?t.jsx(y,{color:"primary"}):t.jsx(q,{columns:H,data:k,progressPending:T,pagination:!0,highlightOnHover:!0,pointerOnHover:!0,responsive:!0,striped:!0,customStyles:{table:{style:{padding:"0",margin:"0"}},headRow:{style:{padding:"1px 2px",fontSize:"11px"}},rows:{style:{minHeight:"25px",padding:"2px"}},cells:{style:{padding:"2px 3px",fontSize:"11px"}}}})]})]})}),t.jsxs(R,{backdrop:"static",visible:F,onClose:()=>c(!1),children:[t.jsx($,{children:t.jsx(K,{children:(s==null?void 0:s.action)==="delete"?"Confirm Delete":"Edit Product"})}),t.jsx(P,{children:(s==null?void 0:s.action)==="delete"?`Apa kamu yakin mau menghapus kategori ${s==null?void 0:s.name} ?`:t.jsxs(t.Fragment,{children:[t.jsx(j,{label:"Name",name:"name",value:f.name,onChange:U,style:{marginBottom:"10px"}}),t.jsx(_,{children:"Unggah Gambar Category Produk"}),t.jsx(J,{pubkey:"ff2ab64366bd0dd50104",maxLocalFileSizeBytes:5e3,multiple:!1,sourceList:"local, url, gdrive",useCloudImageEditor:!0,secureSignature:w,secureExpire:D,onFileUploadStart:()=>n(!0),classNameUploader:"my-config uc-auto",onFileUploadSuccess:e=>{n(!1),m(a=>({...a,image:e.uuid})),console.log(e)}})]})}),t.jsxs(X,{children:[t.jsx(l,{color:"secondary",onClick:()=>c(!1),children:"Cancel"}),t.jsx(l,{color:"primary",onClick:M,children:(s==null?void 0:s.action)==="delete"?"Delete":"Save Changes"})]})]})]})};export{he as default};
