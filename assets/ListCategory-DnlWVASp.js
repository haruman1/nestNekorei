import{r as s,R as N,j as t,C as y}from"./index-BxegOxZp.js";import{a as g,S as i}from"./sweetalert2.esm.all-Dl2JiWyO.js";import{c as O,X as R}from"./index.es-BfmOjfoF.js";import{C as $}from"./index.esm-mMwDcLoS.js";import{H as K}from"./Helmet-xFKRRjvr.js";import{F as P}from"./FileUploaderInline-3fPmcOmO-DD4aVvYN.js";import{a as X,b as l}from"./CContainer-B_sSYCtY.js";import{C as q,a as G}from"./CCardBody-D6oxODFr.js";import{C as V}from"./CCardHeader-DNUdGtqE.js";import{b as j,C as J}from"./CFormInput-C1hi2ZkX.js";import{C as Q,a as W,b as Y,c as Z,d as _}from"./CModalTitle-DQUrDazB.js";import"./DefaultLayout-BYwQMz-r.js";import"./CNavLink-Bf4a02ls.js";import"./Transition-Cqi6SL1v.js";import"./cil-user-Ddrdy7PS.js";import"./isInViewport-BGGX6NGH.js";const xe=()=>{const[d,n]=s.useState(!0),[S,b]=s.useState([]),[k,h]=s.useState([]),[v,E]=s.useState(""),[T,x]=N.useState(!0),[w,B]=s.useState(""),[D,F]=s.useState(""),[o,L]=s.useState(null),[z,c]=s.useState(!1),[f,m]=s.useState({name:"",image:""}),p=async()=>{n(!0),x(!0);try{const e=await g.get("http://localhost:3001/products/categories",{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}});if(e.data.status===200){const a=e.data.data;b(a),h(a)}}catch(e){console.error("Error fetching data:",e)}finally{n(!1),x(!1)}},C=(e,a)=>{a==="edit"&&m({name:e.name,image:e.image}),L({...e,action:a}),c(!0)},I=e=>{const a=e.target.value.toLowerCase();E(a);const r=S.filter(u=>u.name.toLowerCase().includes(a)||u.id.toLowerCase().includes(a)||u.image.toLowerCase().includes(a));h(r)},U=e=>{const{name:a,value:r}=e.target;m({...f,[a]:r})},M=async()=>{o.action==="edit"||o.action==="delete"&&await g.delete(`http://localhost:3001/products/categories/${o.id}`,{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).then(e=>{e.status===200?(p(),i.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:r=>{r.onmouseenter=i.stopTimer,r.onmouseleave=i.resumeTimer}}).fire({icon:"success",title:e.data.message}),setTimeout(()=>{n(!1)},3e3)):(i.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:r=>{r.onmouseenter=i.stopTimer,r.onmouseleave=i.resumeTimer}}).fire({icon:"error",title:e.data.message}),setTimeout(()=>{n(!1)},3e3))}).catch(e=>{onError(e),i.fire("Error","Failed to Delete produk karena "+e.response.message,"error")}),c(!1)},A=async()=>{g.get("http://localhost:3001/users/image/upload").then(e=>{if(e.status===200){const a=e.data;B(a.secureSignature),F(a.secureExpire),console.log(a)}}).catch(e=>{onError("Error fetching signature:",e)})};s.useEffect(()=>{A(),p()},[]);const H=[{name:"No",cell:(e,a)=>a+1,width:"50px",sortable:!1},{name:"ID",selector:e=>e.id,sortable:!0,style:{padding:"4px 8px",fontSize:"14px"}},{name:"Name",selector:e=>e.name,sortable:!0,style:{padding:"4px 8px",fontSize:"14px"}},{name:"Image",selector:e=>e.image?t.jsx("img",{src:`https://ucarecdn.com/${e.image}/`,alt:"Kategori",style:{height:40,width:40}}):t.jsx("img",{src:"https://via.placeholder.com/40x40",alt:"placeholder"}),style:{textAlign:"center"}},{name:"Actions",cell:e=>t.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"10px"},children:[t.jsx(l,{variant:"outline",color:"info",size:"sm",onClick:()=>C(e,"edit"),children:"Edit"}),t.jsx(l,{variant:"outline",color:"danger",size:"sm",onClick:()=>C(e,"delete"),children:"Delete"})]}),width:"150px"}];return t.jsxs(t.Fragment,{children:[t.jsxs(K,{children:[t.jsx("title",{children:"List Produk - Nekorei Management"}),t.jsx("meta",{name:"description",content:"List Produk yang tersedia di Nekoreishion Management"})]}),t.jsx(X,{children:t.jsxs(q,{style:{margin:"10px"},children:[t.jsxs(V,{children:[t.jsx("h3",{style:{marginBottom:"10px",textAlign:"center"},children:"Kategori List"}),t.jsx(l,{color:"primary",onClick:p,disabled:d,style:{float:"right",marginBottom:"10px"},children:d?t.jsx(y,{size:"sm"}):t.jsx($,{icon:O})})]}),t.jsxs(G,{style:{padding:"10px"},children:[t.jsx(j,{type:"text",placeholder:"Search by Name, Description, or ID...",value:v,onChange:I,style:{marginBottom:"10px",width:"300px"}}),d?t.jsx(y,{color:"primary"}):t.jsx(R,{columns:H,data:k,progressPending:T,pagination:!0,highlightOnHover:!0,pointerOnHover:!0,responsive:!0,striped:!0,customStyles:{table:{style:{padding:"0",margin:"0"}},headRow:{style:{padding:"1px 2px",fontSize:"11px"}},rows:{style:{minHeight:"25px",padding:"2px"}},cells:{style:{padding:"2px 3px",fontSize:"11px"}}}})]})]})}),t.jsxs(Q,{backdrop:"static",visible:z,onClose:()=>c(!1),children:[t.jsx(W,{children:t.jsx(Y,{children:(o==null?void 0:o.action)==="delete"?"Confirm Delete":"Edit Product"})}),t.jsx(Z,{children:(o==null?void 0:o.action)==="delete"?`Apa kamu yakin mau menghapus kategori ${o==null?void 0:o.name} ?`:t.jsxs(t.Fragment,{children:[t.jsx(j,{label:"Name",name:"name",value:f.name,onChange:U,style:{marginBottom:"10px"}}),t.jsx(J,{children:"Unggah Gambar Category Produk"}),t.jsx(P,{pubkey:"ff2ab64366bd0dd50104",maxLocalFileSizeBytes:5e3,multiple:!1,sourceList:"local, url, gdrive",useCloudImageEditor:!0,secureSignature:w,secureExpire:D,onFileUploadStart:()=>n(!0),classNameUploader:"my-config uc-auto",onFileUploadSuccess:e=>{n(!1),m(a=>({...a,image:e.uuid})),console.log(e)}})]})}),t.jsxs(_,{children:[t.jsx(l,{color:"secondary",onClick:()=>c(!1),children:"Cancel"}),t.jsx(l,{color:"primary",onClick:M,children:(o==null?void 0:o.action)==="delete"?"Delete":"Save Changes"})]})]})]})};export{xe as default};
