import{r as s,_ as W,R as w,a as q,c as J,P as M,j as e,C as X}from"./index-BB0ary-t.js";import{I as Y,a as Z}from"./imagekitio-react.esm-CjXG_x-_.js";import{a as L}from"./cil-lock-locked-BtT7L54V.js";import{H as _}from"./Helmet-DZyAMZdI.js";import{a as ee}from"./CContainer-BuaRqK5u.js";import{C as m,a as i}from"./CRow-QOAYL5px.js";import{C as ae,a as te}from"./CCardBody-DrDQO12W.js";import{a as R,C as se}from"./CForm-M5x4A6fr.js";import{c as U,C as u,b}from"./CFormInput-BZOZynwh.js";import{C as re}from"./CButton-DHuFRseq.js";import"./Transition-TJu3cpG9.js";var A=s.forwardRef(function(t,C){var o,S=t.children,h=t.className,N=t.feedback,p=t.feedbackInvalid,F=t.feedbackValid,x=t.floatingClassName,P=t.floatingLabel,k=t.htmlSize,j=t.id,g=t.invalid,z=t.label,y=t.options,f=t.size,I=t.text,E=t.tooltipFeedback,d=t.valid,n=W(t,["children","className","feedback","feedbackInvalid","feedbackValid","floatingClassName","floatingLabel","htmlSize","id","invalid","label","options","size","text","tooltipFeedback","valid"]);return w.createElement(U,{describedby:n["aria-describedby"],feedback:N,feedbackInvalid:p,feedbackValid:F,floatingClassName:x,floatingLabel:P,id:j,invalid:g,label:z,text:I,tooltipFeedback:E,valid:d},w.createElement("select",q({id:j,className:J("form-select",(o={},o["form-select-".concat(f)]=f,o["is-invalid"]=g,o["is-valid"]=d,o),h),size:k},n,{ref:C}),y?y.map(function(r,T){return w.createElement("option",q({},typeof r=="object"&&r.disabled&&{disabled:r.disabled},typeof r=="object"&&r.value!==void 0&&{value:r.value},{key:T}),typeof r=="string"?r:r.label)}):S))});A.propTypes=q({className:M.string,htmlSize:M.number,options:M.array},U.propTypes);A.displayName="CFormSelect";const ge=()=>{const[t,C]=s.useState(""),[o,S]=s.useState(""),[h,N]=s.useState(""),[p,F]=s.useState(""),[x,P]=s.useState(""),[k,j]=s.useState(""),[g,z]=s.useState(""),[y,f]=s.useState(!1),[I,E]=s.useState([]),[d,n]=s.useState(null),[r,T]=s.useState(null),[B,c]=s.useState(!1),H=async()=>{try{const a=await fetch("https://x-yq.xyz/users/image/auth");if(!a.ok){const Q=await a.text();throw new d(`Request failed with status ${a.status}: ${Q}`)}const l=await a.json(),{signature:v,expire:G,token:O}=l;return{signature:v,expire:G,token:O}}catch(a){K(`Authentication request failed: ${a.message}`),n("Gagal mengupload foto, server sedang bermasalah")}},D=async()=>{(!t||!o||!h||!p||!x||!k||!g)&&(c(!0),n("Silahkan isi semua kolom dengan benar.")),c(!0);const a={name:t,description:o,price:h,sku:p,quantity:x,categoryId:k,image:g};L.post("https://x-yq.xyz/products",a,{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).then(l=>{l.status===201&&(c(!1),T("Produk berhasil ditambahkan."),V(l.data))}).catch(l=>{c(!1),n(l.response.data.message)})},K=a=>{console.log("Error",a)},V=a=>{c(!1),console.log("Success",a)},$=async()=>{L.get("https://x-yq.xyz/products/categories",{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).then(a=>{if(console.log(a),a.status===200){const l=a.data.data;E(l.map(v=>({id:v.id,name:v.name})))}}).catch(a=>{n("Gagal mengambil data kategori, server sedang bermasalah")})};return s.useEffect(()=>{$()},[]),e.jsxs(e.Fragment,{children:[e.jsxs(_,{children:[e.jsx("title",{children:"Tambah Produk - Nekorei Management"}),e.jsx("meta",{name:"description",content:"Tambah Produk yang tersedia di Nekoreishion Management"})]}),e.jsx(ee,{children:e.jsx(m,{className:"justify-content-center",children:e.jsx(i,{md:8,children:e.jsx(ae,{children:e.jsxs(te,{children:[e.jsx("h3",{className:"mb-4",children:"Tambah Produk"}),r&&e.jsx(R,{color:"success",children:"Produk berhasil ditambahkan!"}),d&&e.jsx(R,{color:"danger",children:d}),e.jsxs(se,{children:[e.jsxs(m,{className:"mb-3",children:[e.jsxs(i,{md:6,children:[e.jsx(u,{htmlFor:"name",children:"Nama Produk"}),e.jsx(b,{type:"text",id:"name",placeholder:"Masukkan nama produk",value:t,onChange:a=>C(a.target.value)})]}),e.jsxs(i,{md:6,children:[e.jsx(u,{htmlFor:"price",children:"Harga"}),e.jsx(b,{type:"number",id:"price",placeholder:"Masukkan harga produk",value:h,onChange:a=>N(a.target.value)})]})]}),e.jsxs(m,{className:"mb-3",children:[e.jsxs(i,{md:6,children:[e.jsx(u,{htmlFor:"sku",children:"SKU"}),e.jsx(b,{type:"text",id:"sku",placeholder:"Masukkan SKU produk",value:p,onChange:a=>F(a.target.value)})]}),e.jsxs(i,{md:6,children:[e.jsx(u,{htmlFor:"quantity",children:"Kuantitas"}),e.jsx(b,{type:"number",id:"quantity",placeholder:"Masukkan jumlah produk",value:x,onChange:a=>P(a.target.value)})]})]}),e.jsx(m,{className:"mb-3",children:e.jsxs(i,{md:12,children:[e.jsx(u,{htmlFor:"description",children:"Deskripsi Produk"}),e.jsx(b,{type:"textarea",id:"description",placeholder:"Masukkan deskripsi produk",value:o,onChange:a=>S(a.target.value)})]})}),e.jsx(m,{className:"mb-3",children:e.jsxs(i,{md:12,children:[e.jsx(u,{htmlFor:"category",children:"Kategori Produk"}),e.jsxs(A,{id:"specificSizeSelect",onChange:a=>j(a.target.value),children:[e.jsx("option",{value:"",children:"--Pilih Kategori--"}),I.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]})}),e.jsx(m,{className:"mb-3",children:e.jsx(i,{md:12,children:e.jsx(Y,{publicKey:"public_QnAbe++JoAakOIvBBpsbOxvkLPk=",urlEndpoint:"https://ik.imagekit.io/Nekorei",authenticator:H,style:{width:"100%"},children:e.jsxs("label",{style:{display:"inline-block",position:"relative",overflow:"hidden",cursor:"pointer",fontFamily:"Arial, sans-serif",padding:"10px 20px",backgroundColor:y?"#0056b3":"#007bff",color:"#fff",borderRadius:"5px",fontSize:"16px",fontWeight:"600",textAlign:"center",transition:"background-color 0.3s ease"},onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),children:[e.jsx(Z,{style:{position:"absolute",top:0,right:0,margin:0,padding:0,fontSize:"20px",cursor:"pointer",opacity:0},onError:K,folder:"/products",onUploadStart:a=>(c(!0),console.log(a)),onSuccess:a=>(z(a.url),c(!1),console.log(a))}),"Upload an Image"]})})})}),e.jsx(i,{xs:6,children:B?e.jsx("div",{className:"text-center",children:e.jsx(X,{color:"primary"})}):e.jsx(re,{color:"primary",onClick:D,children:"Tambah Produk"})})]})]})})})})})]})};export{ge as default};
