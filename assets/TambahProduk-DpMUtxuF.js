import{r as s,_ as W,R as w,a as A,c as J,P as M,j as e,C as X}from"./index-LIEJRkrL.js";import{I as Y,a as Z}from"./imagekitio-react.esm-CP-2EEcJ.js";import{a as R}from"./cil-lock-locked-zwVFJp_A.js";import{H as _}from"./Helmet-DUZFqjzQ.js";import{a as ee}from"./CContainer-BoogBarz.js";import{C as m,a as i}from"./CRow-BZplSTW2.js";import{C as ae,a as te}from"./CCardBody-QOkoizK2.js";import{a as U,C as se}from"./CForm-GiDIBLCp.js";import{c as B,C as u,b as k}from"./CFormInput-DqRM0xn9.js";import{C as re}from"./CButton-DxiArMZ_.js";import"./Transition-TKWYJH10.js";var K=s.forwardRef(function(t,j){var o,v=t.children,h=t.className,C=t.feedback,p=t.feedbackInvalid,y=t.feedbackValid,g=t.floatingClassName,S=t.floatingLabel,N=t.htmlSize,f=t.id,x=t.invalid,F=t.label,I=t.options,b=t.size,z=t.text,E=t.tooltipFeedback,d=t.valid,n=W(t,["children","className","feedback","feedbackInvalid","feedbackValid","floatingClassName","floatingLabel","htmlSize","id","invalid","label","options","size","text","tooltipFeedback","valid"]);return w.createElement(B,{describedby:n["aria-describedby"],feedback:C,feedbackInvalid:p,feedbackValid:y,floatingClassName:g,floatingLabel:S,id:f,invalid:x,label:F,text:z,tooltipFeedback:E,valid:d},w.createElement("select",A({id:f,className:J("form-select",(o={},o["form-select-".concat(b)]=b,o["is-invalid"]=x,o["is-valid"]=d,o),h),size:N},n,{ref:j}),I?I.map(function(r,T){return w.createElement("option",A({},typeof r=="object"&&r.disabled&&{disabled:r.disabled},typeof r=="object"&&r.value!==void 0&&{value:r.value},{key:T}),typeof r=="string"?r:r.label)}):v))});K.propTypes=A({className:M.string,htmlSize:M.number,options:M.array},B.propTypes);K.displayName="CFormSelect";const fe=()=>{const[t,j]=s.useState(""),[o,v]=s.useState(""),[h,C]=s.useState(""),[p,y]=s.useState(""),[g,S]=s.useState(""),[N,f]=s.useState(""),[x,F]=s.useState(""),[I,b]=s.useState(!1),[z,E]=s.useState([]),[d,n]=s.useState(null),[r,T]=s.useState(null),[q,c]=s.useState(!1),H=async()=>{try{const a=await fetch("http://localhost:3001/users/image/auth");if(!a.ok){const Q=await a.text();throw new d(`Request failed with status ${a.status}: ${Q}`)}const l=await a.json(),{signature:P,expire:G,token:O}=l;return{signature:P,expire:G,token:O}}catch(a){L(`Authentication request failed: ${a.message}`),n("Gagal mengupload foto, server sedang bermasalah")}},D=async()=>{(!t||!o||!h||!p||!g||!N||!x)&&(c(!0),n("Silahkan isi semua kolom dengan benar.")),c(!0);const a={name:t,description:o,price:h,sku:p,quantity:g,categoryId:N,image:x};R.post("http://localhost:3001/products",a,{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).then(l=>{l.status===201&&(c(!1),T("Produk berhasil ditambahkan."),V(l.data),j(""),v(""),C(""),y(""),S(""),f(""),F(""))}).catch(l=>{c(!1),n(l.response.data.message)})},L=a=>{console.log("Error",a)},V=a=>{c(!1),console.log("Success",a)},$=async()=>{R.get("http://localhost:3001/products/categories",{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).then(a=>{if(console.log(a),a.status===200){const l=a.data.data;E(l.map(P=>({id:P.id,name:P.name})))}}).catch(a=>{n("Gagal mengambil data kategori, server sedang bermasalah")})};return s.useEffect(()=>{$()},[]),e.jsxs(e.Fragment,{children:[e.jsxs(_,{children:[e.jsx("title",{children:"Tambah Produk - Nekorei Management"}),e.jsx("meta",{name:"description",content:"Tambah Produk yang tersedia di Nekoreishion Management"})]}),e.jsx(ee,{children:e.jsx(m,{className:"justify-content-center",children:e.jsx(i,{md:8,children:e.jsx(ae,{children:e.jsxs(te,{children:[e.jsx("h3",{className:"mb-4",children:"Tambah Produk"}),r&&e.jsx(U,{color:"success",children:r}),d&&e.jsx(U,{color:"danger",children:d}),e.jsxs(se,{children:[e.jsxs(m,{className:"mb-3",children:[e.jsxs(i,{md:6,children:[e.jsx(u,{htmlFor:"name",children:"Nama Produk"}),e.jsx(k,{type:"text",id:"name",placeholder:"Masukkan nama produk",value:t,onChange:a=>j(a.target.value)})]}),e.jsxs(i,{md:6,children:[e.jsx(u,{htmlFor:"price",children:"Harga"}),e.jsx(k,{type:"number",id:"price",placeholder:"Masukkan harga produk",value:h,onChange:a=>C(a.target.value)})]})]}),e.jsxs(m,{className:"mb-3",children:[e.jsxs(i,{md:6,children:[e.jsx(u,{htmlFor:"sku",children:"SKU"}),e.jsx(k,{type:"text",id:"sku",placeholder:"Masukkan SKU produk",value:p,onChange:a=>y(a.target.value)})]}),e.jsxs(i,{md:6,children:[e.jsx(u,{htmlFor:"quantity",children:"Kuantitas"}),e.jsx(k,{type:"number",id:"quantity",placeholder:"Masukkan jumlah produk",value:g,onChange:a=>S(a.target.value)})]})]}),e.jsx(m,{className:"mb-3",children:e.jsxs(i,{md:12,children:[e.jsx(u,{htmlFor:"description",children:"Deskripsi Produk"}),e.jsx(k,{type:"textarea",id:"description",placeholder:"Masukkan deskripsi produk",value:o,onChange:a=>v(a.target.value)})]})}),e.jsx(m,{className:"mb-3",children:e.jsxs(i,{md:12,children:[e.jsx(u,{htmlFor:"category",children:"Kategori Produk"}),e.jsxs(K,{id:"specificSizeSelect",onChange:a=>f(a.target.value),children:[e.jsx("option",{value:"",children:"--Pilih Kategori--"}),z.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]})}),e.jsx(m,{className:"mb-3",children:e.jsx(i,{md:12,children:e.jsx(Y,{publicKey:"public_QnAbe++JoAakOIvBBpsbOxvkLPk=",urlEndpoint:"https://ik.imagekit.io/Nekorei",authenticator:H,style:{width:"100%"},children:e.jsxs("label",{style:{display:"inline-block",position:"relative",overflow:"hidden",cursor:"pointer",fontFamily:"Arial, sans-serif",padding:"10px 20px",backgroundColor:I?"#0056b3":"#007bff",color:"#fff",borderRadius:"5px",fontSize:"16px",fontWeight:"600",textAlign:"center",transition:"background-color 0.3s ease"},onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1),children:[e.jsx(Z,{style:{position:"absolute",top:0,right:0,margin:0,padding:0,fontSize:"20px",cursor:"pointer",opacity:0},onError:L,folder:"/products",onUploadStart:a=>(c(!0),console.log(a)),onSuccess:a=>(F(a.url),c(!1),console.log(a))}),"Upload an Image"]})})})}),e.jsx(i,{xs:6,children:q?e.jsx("div",{className:"text-center",children:e.jsx(X,{color:"primary"})}):e.jsx(re,{color:"primary",onClick:D,children:"Tambah Produk"})})]})]})})})})})]})};export{fe as default};
