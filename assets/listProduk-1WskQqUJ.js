import{r,_ as j,R as c,a as k,c as S,P as o,j as a,C as ne}from"./index-BB0ary-t.js";import{C as ue,a as Q,S as se}from"./cil-lock-locked-BtT7L54V.js";import{c as me,X as pe}from"./index.es-CxZt8Elb.js";import{C as fe}from"./index.esm-Dj7D1ChR.js";import{H as he}from"./Helmet-DZyAMZdI.js";import{I as le,a as ge,b as ye}from"./imagekitio-react.esm-CjXG_x-_.js";import{a as xe}from"./CContainer-BuaRqK5u.js";import{C as ve,a as be}from"./CCardBody-DrDQO12W.js";import{C as Ce}from"./CCardHeader-BhcC4fGr.js";import{C as L}from"./CButton-DHuFRseq.js";import{b as E}from"./CFormInput-BZOZynwh.js";import{C as ie,a as ke}from"./DefaultLayout-MSQRPYMc.js";import{u as Ne,T as we}from"./Transition-TJu3cpG9.js";import"./routes-BxOR6skz.js";import"./cil-user-Ddrdy7PS.js";import"./isInViewport-BGGX6NGH.js";var X=r.forwardRef(function(t,u){var n=t.children,m=t.className,s=j(t,["children","className"]);return c.createElement("div",k({className:S("modal-content",m)},s,{ref:u}),n)});X.propTypes={children:o.node,className:o.string};X.displayName="CModalContent";var G=r.forwardRef(function(t,u){var n,m=t.children,s=t.alignment,d=t.className,h=t.fullscreen,x=t.scrollable,N=t.size,v=j(t,["children","alignment","className","fullscreen","scrollable","size"]);return c.createElement("div",k({className:S("modal-dialog",(n={"modal-dialog-centered":s==="center"},n[typeof h=="boolean"?"modal-fullscreen":"modal-fullscreen-".concat(h,"-down")]=h,n["modal-dialog-scrollable"]=x,n["modal-".concat(N)]=N,n),d)},v,{ref:u}),m)});G.propTypes={alignment:o.oneOf(["top","center"]),children:o.node,className:o.string,fullscreen:o.oneOfType([o.bool,o.oneOf(["sm","md","lg","xl","xxl"])]),scrollable:o.bool,size:o.oneOf(["sm","lg","xl"])};G.displayName="CModalDialog";var ce=r.createContext({}),J=r.forwardRef(function(t,u){var n=t.children,m=t.alignment,s=t.backdrop,d=s===void 0?!0:s,h=t.className,x=t.container,N=t.duration,v=N===void 0?150:N,M=t.focus,q=M===void 0?!0:M,H=t.fullscreen,B=t.keyboard,$=B===void 0?!0:B,b=t.onClose,l=t.onClosePrevented,K=t.onShow,g=t.portal,T=g===void 0?!0:g,P=t.scrollable,U=t.size,R=t.transition,z=R===void 0?!0:R,A=t.unmountOnClose,I=A===void 0?!0:A,y=t.visible,V=j(t,["children","alignment","backdrop","className","container","duration","focus","fullscreen","keyboard","onClose","onClosePrevented","onShow","portal","scrollable","size","transition","unmountOnClose","visible"]),O=r.useRef(null),w=r.useRef(null),e=r.useRef(null),i=Ne(u,w),C=r.useState(y),p=C[0],D=C[1],F=r.useState(!1),ee=F[0],te=F[1],de={visible:p,setVisible:D};r.useEffect(function(){D(y)},[y]),r.useEffect(function(){var f;return p?(O.current=document.activeElement,document.addEventListener("mouseup",ae),document.addEventListener("keydown",re)):(f=O.current)===null||f===void 0||f.focus(),function(){document.removeEventListener("mouseup",ae),document.removeEventListener("keydown",re)}},[p]);var oe=function(){return d==="static"?te(!0):(D(!1),b&&b())};r.useLayoutEffect(function(){l&&l(),setTimeout(function(){return te(!1)},v)},[ee]),r.useLayoutEffect(function(){return p?(document.body.classList.add("modal-open"),d&&(document.body.style.overflow="hidden",document.body.style.paddingRight="0px"),setTimeout(function(){var f;q&&((f=w.current)===null||f===void 0||f.focus())},z?v:0)):(document.body.classList.remove("modal-open"),d&&(document.body.style.removeProperty("overflow"),document.body.style.removeProperty("padding-right"))),function(){document.body.classList.remove("modal-open"),d&&(document.body.style.removeProperty("overflow"),document.body.style.removeProperty("padding-right"))}},[p]);var ae=function(f){w.current&&w.current==f.target&&oe()},re=function(f){f.key==="Escape"&&$&&oe()};return c.createElement(c.Fragment,null,c.createElement(we,{in:p,mountOnEnter:!0,nodeRef:w,onEnter:K,onExit:b,unmountOnExit:I,timeout:z?v:0},function(f){return c.createElement(ie,{container:x,portal:T},c.createElement(ce.Provider,{value:de},c.createElement("div",k({className:S("modal",{"modal-static":ee,fade:z,show:f==="entered"},h),tabIndex:-1},p?{"aria-modal":!0,role:"dialog"}:{"aria-hidden":"true"},{style:k({},f!=="exited"&&{display:"block"})},V,{ref:i}),c.createElement(G,{alignment:m,fullscreen:H,scrollable:P,size:U},c.createElement(X,{ref:e},n)))))}),d&&c.createElement(ie,{container:x,portal:T},c.createElement(ke,{visible:p})))});J.propTypes={alignment:o.oneOf(["top","center"]),backdrop:o.oneOfType([o.bool,o.oneOf(["static"])]),children:o.node,className:o.string,container:o.any,duration:o.number,focus:o.bool,fullscreen:o.oneOfType([o.bool,o.oneOf(["sm","md","lg","xl","xxl"])]),keyboard:o.bool,onClose:o.func,onClosePrevented:o.func,onShow:o.func,portal:o.bool,scrollable:o.bool,size:o.oneOf(["sm","lg","xl"]),transition:o.bool,unmountOnClose:o.bool,visible:o.bool};J.displayName="CModal";var W=r.forwardRef(function(t,u){var n=t.children,m=t.className,s=j(t,["children","className"]);return c.createElement("div",k({className:S("modal-body",m)},s,{ref:u}),n)});W.propTypes={children:o.node,className:o.string};W.displayName="CModalBody";var Y=r.forwardRef(function(t,u){var n=t.children,m=t.className,s=j(t,["children","className"]);return c.createElement("div",k({className:S("modal-footer",m)},s,{ref:u}),n)});Y.propTypes={children:o.node,className:o.string};Y.displayName="CModalFooter";var Z=r.forwardRef(function(t,u){var n=t.children,m=t.className,s=t.closeButton,d=s===void 0?!0:s,h=j(t,["children","className","closeButton"]),x=r.useContext(ce).setVisible;return c.createElement("div",k({className:S("modal-header",m)},h,{ref:u}),n,d&&c.createElement(ue,{onClick:function(){return x(!1)}}))});Z.propTypes={children:o.node,className:o.string,closeButton:o.bool};Z.displayName="CModalHeader";var _=r.forwardRef(function(t,u){var n=t.children,m=t.as,s=m===void 0?"h5":m,d=t.className,h=j(t,["children","as","className"]);return c.createElement(s,k({className:S("modal-title",d)},h,{ref:u}),n)});_.propTypes={as:o.elementType,children:o.node,className:o.string};_.displayName="CModalTitle";const He=()=>{const[t,u]=r.useState(null),[n,m]=r.useState(null),[s,d]=r.useState(!0),[h,x]=r.useState([]),[N,v]=r.useState([]),[M,q]=r.useState(""),[H,B]=r.useState(!0),[$,b]=r.useState(!1),[l,K]=r.useState(null),[g,T]=r.useState({name:"",description:"",price:"",quantity:"",sku:"",categoryId:"",image:""}),P=e=>{console.log("Error",e)},[U,R]=r.useState(!1),z=async()=>{try{const e=await fetch("https://x-yq.xyz/users/image/auth");if(!e.ok){const F=await e.text();throw new t(`Request failed with status ${e.status}: ${F}`)}const i=await e.json(),{signature:C,expire:p,token:D}=i;return{signature:C,expire:p,token:D}}catch(e){P(`Authentication request failed: ${e.message}`),u("Gagal mengupload foto, server sedang bermasalah")}},A=async()=>{if(l.action==="delete")try{await Q.delete(`https://x-yq.xyz/products/${l.id}`,{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}),I()}catch(e){console.error("Error deleting product:",e)}else l.action==="edit"&&await Q.put(`https://x-yq.xyz/products/${l.id}`,g,{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).then(e=>{e.status===200&&(I(),se.fire("Success",e.message,"success"))}).catch(e=>{se.fire("Error","Failed to update product karena "+e.response.message,"error")});b(!1)},I=async()=>{d(!0),B(!0);try{const e=await Q.get("https://x-yq.xyz/products",{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}});if(e.data.status===200){const i=e.data.data;x(i),v(i)}}catch(e){console.error("Error fetching data:",e)}finally{d(!1),B(!1)}},y=e=>{const{name:i,value:C}=e.target;T({...g,[i]:C})},V=e=>{const i=e.target.value.toLowerCase();q(i);const C=h.filter(p=>p.name.toLowerCase().includes(i)||p.description.toLowerCase().includes(i)||p.id.toLowerCase().includes(i)||p.categoryId.toLowerCase().includes(i));v(C)},O=(e,i)=>{i==="edit"&&T({name:e.name,description:e.description,price:e.price,quantity:e.quantity,sku:e.sku,categoryId:e.categoryId,image:e.image}),K({...e,action:i}),b(!0)};r.useEffect(()=>{I()},[]);const w=[{name:"No",cell:(e,i)=>i+1,width:"50px",sortable:!1},{name:"ID",selector:e=>e.id,sortable:!0,width:"140px"},{name:"Name",selector:e=>e.name,sortable:!0,width:"150px"},{name:"Description",selector:e=>e.description,width:"160px",cell:e=>e.description.slice(0,10)+"..."},{name:"Price",selector:e=>`Rp.${parseFloat(e.price).toFixed(2)}`,sortable:!0,width:"120px"},{name:"Quantity",selector:e=>e.quantity,sortable:!0,width:"100px"},{name:"SKU",selector:e=>e.sku,width:"80px"},{name:"Category ID",selector:e=>e.categoryId,width:"120px"},{name:"Image",selector:e=>e.image?a.jsx(le,{urlEndpoint:"https://ik.imagekit.io/Nekorei",children:a.jsx(ye,{src:e.image,transformation:[{height:40,width:40}],loading:"lazy",height:"40",width:"40"})}):"No Image",width:"80px",style:{textAlign:"center"}},{name:"Actions",cell:e=>a.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"10px"},children:[a.jsx(L,{variant:"outline",color:"info",size:"sm",onClick:()=>O(e,"edit"),children:"Edit"}),a.jsx(L,{variant:"outline",color:"danger",size:"sm",onClick:()=>O(e,"delete"),children:"Delete"})]}),width:"150px"}];return a.jsxs(a.Fragment,{children:[a.jsxs(he,{children:[a.jsx("title",{children:"List Produk - Nekorei Management"}),a.jsx("meta",{name:"description",content:"List Produk yang tersedia di Nekoreishion Management"})]}),a.jsx(xe,{children:a.jsxs(ve,{children:[a.jsx(Ce,{children:a.jsx("h3",{children:"List Produk"})}),a.jsxs(be,{children:[a.jsx(L,{color:"primary",onClick:I,disabled:s,style:{float:"right"},children:s?a.jsx(ne,{size:"sm"}):a.jsx(fe,{icon:me})}),a.jsx(E,{type:"text",placeholder:"Search by Name, Description, or ID...",value:M,onChange:V,style:{marginBottom:"20px",padding:"5px",width:"300px"}}),s?a.jsx(ne,{color:"primary"}):a.jsx(pe,{columns:w,data:N,progressPending:H,pagination:!0,highlightOnHover:!0,pointerOnHover:!0,responsive:!0,striped:!0,customStyles:{cells:{style:{padding:"8px 10px"}}}})]})]})}),a.jsxs(J,{backdrop:"static",visible:$,onClose:()=>b(!1),children:[a.jsx(Z,{children:a.jsx(_,{children:(l==null?void 0:l.action)==="delete"?"Confirm Delete":"Edit Product"})}),a.jsx(W,{children:(l==null?void 0:l.action)==="delete"?`Are you sure you want to delete the product ${l==null?void 0:l.name}?`:a.jsxs(a.Fragment,{children:[n&&a.jsx(CAlert,{color:"success",children:"Produk berhasil ditambahkan!"}),t&&a.jsx(CAlert,{color:"danger",children:t}),a.jsx(E,{label:"Name",name:"name",value:g.name,onChange:y,style:{marginBottom:"10px"}}),a.jsx(E,{label:"Description",name:"description",value:g.description,onChange:y,style:{marginBottom:"10px"}}),a.jsx(E,{label:"Price",name:"price",type:"number",value:g.price,onChange:y,style:{marginBottom:"10px"}}),a.jsx(E,{label:"Quantity",name:"quantity",type:"number",value:g.quantity,onChange:y,style:{marginBottom:"10px"}}),a.jsx(E,{label:"SKU",name:"sku",value:g.sku,onChange:y,style:{marginBottom:"10px"}}),a.jsx(E,{label:"Category ID",name:"categoryId",value:g.categoryId,onChange:y,style:{marginBottom:"10px"}}),a.jsx(le,{publicKey:"public_QnAbe++JoAakOIvBBpsbOxvkLPk=",urlEndpoint:"https://ik.imagekit.io/Nekorei",authenticator:z,style:{width:"100%"},children:a.jsxs("label",{style:{display:"inline-block",position:"relative",overflow:"hidden",cursor:"pointer",fontFamily:"Arial, sans-serif",padding:"10px 20px",backgroundColor:U?"#0056b3":"#007bff",color:"#fff",borderRadius:"5px",fontSize:"16px",fontWeight:"600",textAlign:"center",transition:"background-color 0.3s ease"},onMouseEnter:()=>R(!0),onMouseLeave:()=>R(!1),children:[a.jsx(ge,{style:{position:"absolute",top:0,right:0,margin:0,padding:0,fontSize:"20px",cursor:"pointer",opacity:0},type:"file",accept:"image/*",onError:P,folder:"/products",onUploadStart:e=>(d(!0),console.log(e)),onSuccess:e=>(setImageUrl(e.url),d(!1),console.log(e))}),"Upload an Image"]})})]})}),a.jsxs(Y,{children:[a.jsx(L,{color:"secondary",onClick:()=>b(!1),children:"Cancel"}),a.jsx(L,{color:"primary",onClick:A,children:(l==null?void 0:l.action)==="delete"?"Delete":"Save Changes"})]})]})]})};export{He as default};
